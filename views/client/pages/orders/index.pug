extends ../../layouts/default

block main
    .container.my-4
        h2.mb-4 Đơn hàng của tôi

        if !orders || orders.length === 0
            p Bạn chưa có đơn hàng nào.
        else
            each order in orders
                .order-box(
                    style="border:1px solid #ddd;padding:16px;border-radius:8px;margin-bottom:22px;background:#fff;"
                )

                    // ===== HEADER ĐƠN HÀNG =====
                    .d-flex.justify-content-between.align-items-center
                        h3(style="font-size:20px;") Đơn hàng ##{order._id}

                        // MÀU TRẠNG THÁI
                        if order.status === 'pending'
                            span.badge.bg-warning.text-dark Đang xử lý
                        else if order.status === 'confirmed'
                            span.badge.bg-info.text-dark Đã duyệt
                        else if order.status === 'shipping'
                            span.badge.bg-primary.text-white Đang giao
                        else if order.status === 'completed'
                            span.badge.bg-success.text-white Hoàn tất
                        else if order.status === 'cancelled'
                            span.badge.bg-danger.text-white Đã hủy

                    p.text-muted.mt-1 Ngày đặt: #{order.createdAt.toLocaleString()}

                    hr

                    // ===== THÔNG TIN GIAO HÀNG =====
                    h4(style="font-size:18px;margin-top:10px;") Thông tin giao hàng

                    if order.shippingInfo
                        p Tên: #{order.shippingInfo.name}
                        p SĐT: #{order.shippingInfo.phone}
                        p Địa chỉ: #{order.shippingInfo.address}
                    else
                        p(style="color:#777;") Không có thông tin giao hàng.

                    hr

                    // ===== DANH SÁCH SẢN PHẨM =====
                    h4(style="font-size:18px;margin-top:10px;") Sản phẩm

                    table.table.table-bordered.align-middle
                        thead.table-light
                            tr
                                th(style="width:80px;") Ảnh
                                th Tên
                                th(style="width:60px;") SL
                                th Giá
                                th Thành tiền

                        tbody
                            each item in order.items
                                tr
                                    td
                                        img(src=item.thumbnail, width="60", style="border-radius:6px;")
                                    td #{item.title}
                                    td #{item.quantity}
                                    td $#{item.price}
                                    td $#{(item.quantity * item.price).toFixed(2)}

                    // ===== TỔNG TIỀN =====
                    h4.mt-3
                        | Tổng thanh toán: 
                        span.text-danger $#{order.total.toFixed(2)}

                    // ===== CÁC NÚT CHỨC NĂNG =====
                    .mt-3

                        a.btn.btn-primary(href=`/orders/${order._id}`) Xem chi tiết

